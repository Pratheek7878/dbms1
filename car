
CREATE DATABASE INSURANCE
USE INSURANCE
CREATE TABLE PERSON(
DRIVERID VARCHAR(10),
NAME VARCHAR(10),
ADDRESS VARCHAR(10),
PRIMARY KEY(DRIVERID)
)
INSERT INTO PERSON VALUES('1','A','UDUPI')
INSERT INTO PERSON VALUES('2','B','KARKALA')
INSERT INTO PERSON VALUES('3','JOHN SMITH','KUNDAPURA')
INSERT INTO PERSON VALUES('4','D','UDUPI')
INSERT INTO PERSON VALUES('5','E','SALVADY')
SELECT * FROM PERSON
CREATE TABLE CAR(
REGNO VARCHAR(10),
MODEL VARCHAR(10),
YEAR INT,
PRIMARY KEY(REGNO)
)
INSERT INTO CAR VALUES('KA-11','SWIFT',2004)
INSERT INTO CAR VALUES('KA-12','SANTRO',1980)
INSERT INTO CAR VALUES('KA-13','RITZ',1999)
INSERT INTO CAR VALUES('KA-14','BREZZA',2009)
INSERT INTO CAR VALUES('KA-15','VENUE',2000)
SELECT * FROM CAR
CREATE TABLE ACCIDENT(
REPORTNO INT,
ACCDATE DATE,
LOCATION VARCHAR(10),
PRIMARY KEY(REPORTNO)
)
INSERT INTO ACCIDENT VALUES(1,'1989-01-19','UDUPI')
INSERT INTO ACCIDENT VALUES(2,'1999-01-19','KARKALA')
INSERT INTO ACCIDENT VALUES(3,'1979-03-19','KUNDAPURA')
INSERT INTO ACCIDENT VALUES(4,'1989-05-19','UDUPI')
INSERT INTO ACCIDENT VALUES(5,'1989-01-25','GADAG')
SELECT * FROM ACCIDENT
CREATE TABLE OWNS(
DRIVERID VARCHAR(10),
REGNO VARCHAR(10),
PRIMARY KEY(DRIVERID,REGNO),
FOREIGN KEY(DRIVERID) REFERENCES PERSON(DRIVERID) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(REGNO) REFERENCES CAR(REGNO) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO OWNS VALUES('1','KA-11')
INSERT INTO OWNS VALUES('2','KA-12')
INSERT INTO OWNS VALUES('1','KA-13')
INSERT INTO OWNS VALUES('3','KA-12')
INSERT INTO OWNS VALUES('4','KA-15')
SELECT * FROM OWNS
CREATE TABLE PARTICIPATED(
DRIVERID VARCHAR(10),
REGNO VARCHAR(10),
REPORTNO INT,
DMGAMT INT,
PRIMARY KEY(DRIVERID,REGNO,REPORTNO),
FOREIGN KEY(DRIVERID) REFERENCES PERSON(DRIVERID) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(REGNO) REFERENCES CAR(REGNO) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(REPORTNO) REFERENCES ACCIDENT(REPORTNO) ON DELETE CASCADE ON
UPDATE CASCADE
)
INSERT INTO PARTICIPATED VALUES('1','KA-12',1,2000)
INSERT INTO PARTICIPATED VALUES('2','KA-11',2,1000)
INSERT INTO PARTICIPATED VALUES('3','KA-12',1,9000)
INSERT INTO PARTICIPATED VALUES('3','KA-14',4,2000)
INSERT INTO PARTICIPATED VALUES('1','KA-11',5,8000)
SELECT * FROM PARTICIPATED
#1
SELECT COUNT(DISTINCT P.DRIVERID)AS CAROWNER
FROM ACCIDENT A,PARTICIPATED P
WHERE A.REPORTNO=P.REPORTNO
AND YEAR(ACCDATE)='1989'
#2
SELECT COUNT(P.REPORTNO)AS NOOFACC
FROM PARTICIPATED P,PERSON A
WHERE P.DRIVERID=A.DRIVERID AND A.NAME='JOHN SMITH'
#3
UPDATE PARTICIPATED
SET DMGAMT=3000
WHERE REGNO='KA-12' AND REPORTNO=1
SELECT * FROM PARTICIPATED
DROP TABLE PARTICIPATED
DROP TABLE OWNS
DROP TABLE ACCIDENT
DROP TABLE CAR
DROP TABLE PERSON
