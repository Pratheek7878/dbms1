CREATE DATABASE AUTHOR
USE AUTHOR
CREATE TABLE AUTHOR(
AUTHORID INT,
ANAME VARCHAR(10),
CITY VARCHAR(10),
COUNTRY VARCHAR(10),
PRIMARY KEY(AUTHORID)
)
INSERT INTO AUTHOR VALUES(1,'RON','ABC','XYZ')
INSERT INTO AUTHOR VALUES(2,'DON','NBC','QYZ')
INSERT INTO AUTHOR VALUES(3,'CON','MBC','WYZ')
INSERT INTO AUTHOR VALUES(4,'AON','TBC','YYZ')
INSERT INTO AUTHOR VALUES(5,'BON','PBC','MYZ')
SELECT * FROM AUTHOR
CREATE TABLE PUBLISHER(
PUBID INT,
PNAME VARCHAR(10),
CITY VARCHAR(10),
COUNTRY VARCHAR(10),
PRIMARY KEY(PUBID)
)
INSERT INTO PUBLISHER VALUES(10,'PEGION','ABC','LYZ')
INSERT INTO PUBLISHER VALUES(20,'TOM','DBC','XKZ')
INSERT INTO PUBLISHER VALUES(30,'JERRY','KBC','LYZ')
INSERT INTO PUBLISHER VALUES(40,'PEACOCK','KBC','XYG')
INSERT INTO PUBLISHER VALUES(50,'DUCK','AJC','MYZ')
SELECT * FROM PUBLISHER
CREATE TABLE CATEGORY
(
CATID INT,
DESCR VARCHAR(10),
PRIMARY KEY(CATID)
)
INSERT INTO CATEGORY VALUES(5,'ABC')
INSERT INTO CATEGORY VALUES(6,'YBC')
INSERT INTO CATEGORY VALUES(7,'KBC')
SELECT * FROM CATEGORY
CREATE TABLE CATALOG(
BOOKID INT,
TITLE VARCHAR(10),
AUTHORID INT,
PUBID INT,
CATID INT,
YEAR INT,
PRICE INT,
PRIMARY KEY(BOOKID),
FOREIGN KEY(AUTHORID) REFERENCES AUTHOR(AUTHORID) ON DELETE CASCADE ON
UPDATE CASCADE,
FOREIGN KEY(PUBID) REFERENCES PUBLISHER(PUBID) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(CATID) REFERENCES CATEGORY(CATID) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO CATALOG VALUES(101,'JACK',1,10,5,2004,6000)
INSERT INTO CATALOG VALUES(102,'HORROR',2,30,6,2014,9000)
INSERT INTO CATALOG VALUES(103,'COMEDY',1,20,7,2008,3000)
INSERT INTO CATALOG VALUES(104,'DISNEY',4,10,5,2001,5000)
INSERT INTO CATALOG VALUES(105,'CARTOON',2,30,7,2024,2000)
SELECT * FROM CATALOG
CREATE TABLE ORDERDETAILS(
ORDERNO INT,
BOOKID INT,
QTY INT,
PRIMARY KEY(ORDERNO,BOOKID),
FOREIGN KEY(BOOKID) REFERENCES CATALOG(BOOKID) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO ORDERDETAILS VALUES(200,101,45)
INSERT INTO ORDERDETAILS VALUES(201,102,46)
INSERT INTO ORDERDETAILS VALUES(202,101,10)
INSERT INTO ORDERDETAILS VALUES(203,104,5)
INSERT INTO ORDERDETAILS VALUES(204,104,1)
SELECT * FROM ORDERDETAILS
#1
SELECT A.AUTHORID,A.ANAME,C.BOOKID,SUM(O.QTY)
FROM AUTHOR A,CATALOG C,ORDERDETAILS O
WHERE A.AUTHORID=C.AUTHORID AND C.BOOKID=O.BOOKID
GROUP BY A.AUTHORID,A.ANAME,C.BOOKID
HAVING SUM(O.QTY)>=ALL(SELECT SUM(QTY)
 FROM ORDERDETAILS
 GROUP BY BOOKID)
#2
UPDATE CATALOG
SET PRICE=1.1*PRICE
WHERE PUBID IN (SELECT PUBID FROM PUBLISHER WHERE PNAME='PEGION')
SELECT*FROM CATALOG
#3
SELECT O.BOOKID,COUNT(*)
FROM ORDERDETAILS O
GROUP BY O.BOOKID
HAVING SUM(O.QTY)<=ALL(SELECT SUM(QTY)
 FROM ORDERDETAILS
 GROUP BY BOOKID)
