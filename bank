CREATE DATABASE BANKING1
USE BANKING1
CREATE TABLE BRANCH(
BNAME VARCHAR(10),
BCITY VARCHAR(10),
ASSESTS REAL,
PRIMARY KEY(BNAME)
)
INSERT INTO BRANCH VALUES('SYNDICATE','MANIPAL',2.5)
INSERT INTO BRANCH VALUES('BHARAT','MANIPAL',2.5)
INSERT INTO BRANCH VALUES('JANATA','MANIPAL',2.5)
INSERT INTO BRANCH VALUES('TATA','UDUPI',2.5)
INSERT INTO BRANCH VALUES('SAI','UDUPI',2.5)
INSERT INTO BRANCH VALUES('CANARA','KUNDAPURA',2.5)
SELECT * FROM BRANCH
CREATE TABLE ACCOUNT(
ACCNO INT,
BNAME VARCHAR(10),
BALANCE REAL,
PRIMARY KEY(ACCNO),
FOREIGN KEY(BNAME) REFERENCES BRANCH(BNAME) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO ACCOUNT VALUES(1,'TATA',2.5)
INSERT INTO ACCOUNT VALUES(2,'TATA',2.5)
INSERT INTO ACCOUNT VALUES(3,'SAI',2.5)
INSERT INTO ACCOUNT VALUES(4,'SAI',2.5)
INSERT INTO ACCOUNT VALUES(5,'SYNDICATE',2.5)
INSERT INTO ACCOUNT VALUES(6,'BHARAT',2.5)
INSERT INTO ACCOUNT VALUES(7,'JANATA',2.5)
INSERT INTO ACCOUNT VALUES(8,'TATA',2.5)
INSERT INTO ACCOUNT VALUES(9,'SAI',2.5)
INSERT INTO ACCOUNT VALUES(10,'CANARA',2.5)
INSERT INTO ACCOUNT VALUES(11,'SYNDICATE',2.5)
INSERT INTO ACCOUNT VALUES(12,'CANARA',2.5)
SELECT * FROM ACCOUNT
CREATE TABLE CUSTOMER(
CNAME VARCHAR(10),
CSTREET VARCHAR(10),
CCITY VARCHAR(10),
PRIMARY KEY(CNAME)
)
INSERT INTO CUSTOMER VALUES('SOHAN','S1','C1')
INSERT INTO CUSTOMER VALUES('ROHAN','S2','C2')
INSERT INTO CUSTOMER VALUES('MOHAN','S3','C3')
INSERT INTO CUSTOMER VALUES('LOHAN','S4','C4')
SELECT * FROM CUSTOMER
CREATE TABLE DEPOSITOR(
CNAME VARCHAR(10),
ACCNO INT,
PRIMARY KEY(CNAME,ACCNO),
FOREIGN KEY(CNAME) REFERENCES CUSTOMER(CNAME) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(ACCNO) REFERENCES ACCOUNT(ACCNO) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO DEPOSITOR VALUES('SOHAN',1)
INSERT INTO DEPOSITOR VALUES('SOHAN',2)
INSERT INTO DEPOSITOR VALUES('SOHAN',3)
INSERT INTO DEPOSITOR VALUES('SOHAN',4)
INSERT INTO DEPOSITOR VALUES('ROHAN',5)
INSERT INTO DEPOSITOR VALUES('ROHAN',6)
INSERT INTO DEPOSITOR VALUES('ROHAN',7)
INSERT INTO DEPOSITOR VALUES('ROHAN',8)
INSERT INTO DEPOSITOR VALUES('ROHAN',9)
INSERT INTO DEPOSITOR VALUES('ROHAN',10)
INSERT INTO DEPOSITOR VALUES('MOHAN',11)
INSERT INTO DEPOSITOR VALUES('MOHAN',12)
SELECT * FROM DEPOSITOR
CREATE TABLE LOAN (
LNO INT,
BNAME VARCHAR(10),
AMOUNT REAL,
PRIMARY KEY(LNO),
FOREIGN KEY(BNAME) REFERENCES BRANCH (BNAME) ON DELETE CASCADE ON UPDATE
CASCADE
)
INSERT INTO LOAN VALUES(10,'CANARA',2.3)
INSERT INTO LOAN VALUES(20,'TATA',2.3)
SELECT * FROM LOAN
CREATE TABLE BORROWER(
CNAME VARCHAR(10),
LNO INT,
PRIMARY KEY(CNAME,LNO),
FOREIGN KEY(CNAME) REFERENCES CUSTOMER(CNAME) ON DELETE CASCADE ON UPDATE
CASCADE,
FOREIGN KEY(LNO) REFERENCES LOAN(LNO) ON DELETE CASCADE ON UPDATE CASCADE
)
INSERT INTO BORROWER VALUES('SOHAN',10)
INSERT INTO BORROWER VALUES('ROHAN',20)
SELECT * FROM BORROWER
SELECT C.CNAME 
FROM CUSTOMER C
WHERE NOT EXISTS(SELECT B.BNAME 
 FROM BRANCH B
 WHERE B.BCITY='UDUPI'
 AND B.BNAME NOT IN( SELECT A.BNAME
 FROM ACCOUNT A, DEPOSITOR D
 WHERE A.ACCNO=D.ACCNO
 AND A.BNAME=B.BNAME
 AND D.CNAME=C.CNAME
 GROUP BY A.BNAME
HAVING COUNT(A.BNAME)>=2))
SELECT C1.CNAME
FROM CUSTOMER C1
WHERE NOT EXISTS( SELECT DISTINCT B1.BCITY
 FROM BRANCH B1
 WHERE B1.BCITY NOT IN( SELECT DISTINCT B.BCITY
 FROM BRANCH B,ACCOUNT A,DEPOSITOR D
 WHERE A.BNAME=B.BNAME
 AND A.ACCNO=D.ACCNO
 AND D.CNAME=C1.CNAME))
SELECT C1.CNAME
FROM CUSTOMER C1
WHERE EXISTS(SELECT COUNT(DISTINCT B.BNAME)
 FROM BRANCH B,ACCOUNT A, DEPOSITOR D
 WHERE B.BNAME=A.BNAME
 AND A.ACCNO=D.ACCNO
 AND D.CNAME=C1.CNAME
 AND B.BCITY='MANIPAL'
 GROUP BY B.BCITY
 HAVING COUNT(DISTINCT B.BNAME)>=2)
DROP TABLE BORROWER
DROP TABLE LOAN
DROP TABLE DEPOSITOR
DROP TABLE CUSTOMER
DROP TABLE ACCOUNT
DROP TABLE BRANC
